library(ggplot2)
library(reshape2)
library(scater)
args<-commandArgs(T)
data<-read.table(args[1],sep="\t",header=T)
meltdata<-melt(data,id="Type")
png(filename = args[2],width=960,height=240)
ggplot(meltdata)+geom_jitter(aes(x=variable,y=value,col=Type),size=0.1)+scale_color_manual(values=c("#5aae61","#c2a5cf"))+theme_bw()+theme(axis.text.x=element_blank(),panel.grid.major=element_blank(),panel.grid.minor=element_blank())+xlab("")+ylab("")
dev.off()
#do tSNE analysis
library(Rtsne)
Labels<-data$Type
set.seed(42)
tsne <- Rtsne(data[,seq(1,length(data[1,])-1)], dims = 2, perplexity=30, verbose=TRUE, max_iter = 10000)
tSNEdata<-as.data.frame(cbind(tsne$Y,data$Type))
pdf(args[3])
ggplot(tSNEdata)+geom_point(aes(x=V1,y=V2,col=as.factor(V3)),size=1)+theme_bw()+scale_color_manual(values=c("#5aae61","#c2a5cf"))+theme_bw()+theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+xlab("tSNE-1")+ylab("tSNE-2")
dev.off()
Negative<-data[data$Type=="Negative",]
meltNegative<-melt(Negative,id="Type")
Positive<-data[data$Type=="Positive",]
meltPositive<-melt(Positive,id="Type")
pdf(args[4],width=16,height=5)
p1<-ggplot(meltNegative,aes(x=variable,y=value))+geom_boxplot(outlier.shape =NA,col="#5aae61")+geom_hline(yintercept=0,col="red3",linetype="dashed")+theme_bw()+theme(axis.text.x=element_blank(),panel.grid.major=element_blank(),panel.grid.minor=element_blank())+xlab("Events")+ylab("Input score")
p2<-ggplot(meltPositive,aes(x=variable,y=value))+geom_boxplot(outlier.shape =NA,col="#c2a5cf")+geom_hline(yintercept=0,col="red3",linetype="dashed")+theme_bw()+theme(axis.text.x=element_blank(),panel.grid.major=element_blank(),panel.grid.minor=element_blank())+xlab("Events")+ylab("Input score")
multiplot(p1,p2,cols=2)
dev.off()
