library(e1071)
library(ggplot2)
library(reshape2)
data<-read.table("matrix_EventCoverage_D_Nmix",sep="\t",header=T,row.names=1,check.names=F,stringsAsFactors=TRUE)
data_N<-melt(data)
data<-read.table("matrix_EventCoverage_D_Positive",sep="\t",header=T,row.names=1,check.names=F,stringsAsFactors=TRUE)
data_P<-melt(data)
P<-cbind(data_P,rep("Positive",length(data_P[,1])))
N<-cbind(data_N,rep("Negative",length(data_N[,1])))
colnames(P)<-c("Zscore","Percent","label")
colnames(N)<-c("Zscore","Percent","label")
SVM_Input_D<-rbind(P,N)
SVM_Input_D$Percent<-as.numeric(as.character(SVM_Input_D$Percent))
SVM_Input_D$Zscore<-as.numeric(as.character(SVM_Input_D$Zscore))
SVM_Input_D$label<-as.factor(SVM_Input_D$label)
data<-read.table("matrix_EventCoverage_I_Nmix",sep="\t",header=T,row.names=1,check.names=F,stringsAsFactors=FALSE)
data_N<-melt(data)
data<-read.table("matrix_EventCoverage_I_Positive",sep="\t",header=T,row.names=1,check.names=F,stringsAsFactors=FALSE)
data_P<-melt(data)
P<-cbind(data_P,rep("Positive",length(data_P[,1])))
N<-cbind(data_N,rep("Negative",length(data_N[,1])))
colnames(P)<-c("Zscore","Percent","label")
colnames(N)<-c("Zscore","Percent","label")
SVM_Input_I<-rbind(P,N)
SVM_Input_I$Percent<-as.numeric(as.character(SVM_Input_I$Percent))
SVM_Input_I$Zscore<-as.numeric(as.character(SVM_Input_I$Zscore))
SVM_Input_I$label<-as.factor(SVM_Input_I$label)
svm_model_after_tune<-svm(label ~ ., data=SVM_Input_D, type="C-classification", kernel="radial", cost=40, gamma=7, scale=FALSE,probability=TRUE)
grid <- expand.grid(seq(min(SVM_Input_D[, 1]), max(SVM_Input_D[, 1]),length.out=51), seq(min(SVM_Input_D[, 2]), max(SVM_Input_D[, 2]),length.out=51))
names(grid) <- names(SVM_Input_D)[1:2]
preds <- predict(svm_model_after_tune, grid)
df <- data.frame(grid, preds)
write.table(df,"svm_line_D.txt",sep="\t",quote=F,row.names=F,col.names=T)
svm_model_after_tune<-svm(label ~ ., data=SVM_Input_I, type="C-classification", kernel="radial", cost=40, gamma=7, scale=FALSE,probability=TRUE)
grid <- expand.grid(seq(min(SVM_Input_I[, 1]), max(SVM_Input_I[, 1]),length.out=51), seq(min(SVM_Input_I[, 2]), max(SVM_Input_I[, 2]),length.out=51))
names(grid) <- names(SVM_Input_I)[1:2]
preds <- predict(svm_model_after_tune, grid)
df <- data.frame(grid, preds)
write.table(df,"svm_line_I.txt",sep="\t",quote=F,row.names=F,col.names=T)

